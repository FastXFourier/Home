# ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏û‡∏£‡πâ‡∏≠‡∏° code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠ toi20_sculpture
## Link: https://otog.in.th/problem/1015

## ‡∏™‡∏£‡∏∏‡∏õ‡πÇ‡∏à‡∏ó‡∏¢‡πå
‡∏°‡∏µ‡∏´‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà $N$ ‡∏Å‡πâ‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡πâ‡∏≠‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ $W[i]$ (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$) ‡πÅ‡∏•‡∏∞ $L[i]$ (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$ ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ) ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ï‡∏¥‡∏°‡∏≤‡∏Å‡∏£‡∏£‡∏° ‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏î‡∏±‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:
- ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ö‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á ‡πÇ‡∏î‡∏¢‡∏ö‡∏≤‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Å‡πá‡πÑ‡∏î‡πâ
- ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏´‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á $\leq$ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏´‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ
- ‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 1 ‡∏ä‡∏¥‡πâ‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÇ‡∏î‡∏¢‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
‡∏´‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ï‡∏¥‡∏°‡∏≤‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡∏±‡∏Å‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏™‡πà‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡∏±‡∏Å‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏î‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á

## ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
$5$ $\leq$ $N$ $\leq$ $20,000$
$1 \leq W[i] \leq 100,000$
$1 \leq L[i] \leq 5,000,000$

## ‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏´‡∏•‡∏±‡∏Å
‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏¥‡∏î‡πÅ‡∏¢‡∏Å 2 ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏î‡πâ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏Ñ‡∏¥‡∏î‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ö‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏à‡∏≤‡∏Å‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥
‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ Dynamic Programming ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö array ‡πÑ‡∏ß‡πâ 4 ‡∏ï‡∏±‡∏ß ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà
- $dpu[]$ (‡∏¢‡πà‡∏≠‡∏à‡∏≤‡∏Å dp up) ‡πÇ‡∏î‡∏¢ $dpu[i]$ ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏°‡∏≤ $i$ ‡∏≠‡∏±‡∏ô ‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà (‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤ $W$ ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ)
- $dpd[]$ (‡∏¢‡πà‡∏≠‡∏à‡∏≤‡∏Å dp down) ‡πÇ‡∏î‡∏¢ $dpd[i]$ ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏°‡∏≤ $i$ ‡∏≠‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà (‡∏Ñ‡πà‡∏≤ $L$ ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ)
- $up[]$ ‡πÇ‡∏î‡∏¢ $up[i]$ ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÅ‡∏Ñ‡πà‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏ó‡∏µ‡πà $1$ ‡∏ñ‡∏∂‡∏á $i$ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏¥‡∏ö‡∏°‡∏≤‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Å‡∏µ‡πà‡∏Å‡πâ‡∏≠‡∏ô ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡πÉ‡∏ä‡πâ $dpu[]$ ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ
- $down[]$ ‡πÇ‡∏î‡∏¢ $down[i]$ ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÅ‡∏Ñ‡πà‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏ó‡∏µ‡πà $i$ ‡∏ñ‡∏∂‡∏á $N$ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏¥‡∏ö‡∏°‡∏≤‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Å‡∏µ‡πà‡∏Å‡πâ‡∏≠‡∏ô ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡πÉ‡∏ä‡πâ $dpd[]$ ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ
## ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì $up[]$
‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ loop $i$ ‡∏à‡∏≤‡∏Å $1$ ‡∏ñ‡∏∂‡∏á $N$ ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ß‡∏ô ‡πÄ‡∏£‡∏≤‡∏à‡∏∞ loop $j$ ‡∏à‡∏≤‡∏Å $i$ ‡∏ñ‡∏∂‡∏á $1$ ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
- $dpu[j - 1] > l[i]$ 
	- ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏¥‡∏ö‡∏´‡∏¥‡∏ô‡∏°‡∏≤ $j - 1$ ‡∏Å‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$ ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ (‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
- $dpu[j - 1] \leq l[i]$
	- ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ ‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô $j -  1$ ‡∏Å‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡πÑ‡∏î‡πâ $j$ ‡∏Å‡πâ‡∏≠‡∏ô ‡∏à‡∏≤‡∏Å $1$ ‡∏ñ‡∏∂‡∏á $i$ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á $dpu[j]$ ‡πÅ‡∏•‡∏∞ $up[i]$ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
		- $up[i] = max(up[i], j):$ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô $j$ ‡∏Å‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÉ‡∏´‡πâ $up[i]$ ‡πÄ‡∏õ‡πá‡∏ô ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ $j$
		- $dpu[j] =  min(dpu[j], dpu[j - 1] + w[i]):$ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å $dpu[j]$ ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô $j$ ‡∏Å‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÉ‡∏´‡πâ $dpu[j]$ ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ $dpu[j - 1] + w[i]$ (‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô $j - 1$ ‡∏Å‡πâ‡∏≠‡∏ô ‡∏ö‡∏ß‡∏Å‡∏Å‡∏±‡∏ö ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
## ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì $down[]$
‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ loop $i$ ‡∏à‡∏≤‡∏Å $N$ ‡∏ñ‡∏∂‡∏á $1$ ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ß‡∏ô ‡πÄ‡∏£‡∏≤‡∏à‡∏∞ loop $j$ ‡∏à‡∏≤‡∏Å $N - i + 1$ ‡∏ñ‡∏∂‡∏á $1$ (loop ‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏à‡∏∞‡∏ß‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$ ‡∏ñ‡∏∂‡∏á $N$) ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
- $dpd[j - 1] < w[i]$ 
	- ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏¥‡∏ö‡∏´‡∏¥‡∏ô‡∏°‡∏≤ $j - 1$ ‡∏Å‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ (‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
- $dpd[j - 1] \geq w[i]$
	- ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ ‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$ ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô $j -  1$ ‡∏Å‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡πÑ‡∏î‡πâ $j$ ‡∏Å‡πâ‡∏≠‡∏ô ‡∏à‡∏≤‡∏Å $i$ ‡∏ñ‡∏∂‡∏á $N$ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á $dpd[j]$ ‡πÅ‡∏•‡∏∞ $down[i]$ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
		- $down[i]  =  max(down[i], j):$ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô $j$ ‡∏Å‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÉ‡∏´‡πâ $down[i]$ ‡πÄ‡∏õ‡πá‡∏ô ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ $j$
		- $dpd[j]  =  max(dpd[j],  min(l[i], dpd[j -  1]  - w[i])):$ ‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å $dpd[j]$ ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏¥‡∏ö‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô $j$ ‡∏Å‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÉ‡∏´‡πâ $dpd[j]$ ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞ $min(l[i], dpd[j -  1]  - w[i])$ ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡πà‡∏≤ ‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏´‡∏¢‡∏¥‡∏ö‡∏°‡∏≤ (‡∏Å‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà $i$) ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÑ‡∏î‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á $(dpd[j - 1])$ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
## ‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö 
‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ loop ‡∏à‡∏≤‡∏Å $1$ ‡∏ñ‡∏∂‡∏á $N$ ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á $up[i] + down[i + 1]$ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÜ $i$ (‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏£‡∏≤‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ)
## ‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ß‡∏≤‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¢‡∏∏‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å
‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ loop ‡∏à‡∏≤‡∏Å $1$ ‡∏ñ‡∏∂‡∏á $N$ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ä‡πá‡∏Å‡∏ß‡πà‡∏≤ $up[i] + down[i + 1] == mx$ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πà ‡πÉ‡∏´‡πâ‡∏ï‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ $i$ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö whitespace ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÜ $i$
## Summary
- ‡πÉ‡∏ä‡πâ Dynamic Programming ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏ö‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô ‡πÇ‡∏î‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÅ‡∏Ñ‡πà‡πÄ‡∏ä‡πá‡∏Å‡∏ñ‡πâ‡∏≤ $up[i] + down[i + 1] == ans$ ‡∏Å‡πá‡∏û‡∏¥‡∏°‡∏û‡πå $i$ ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ

## Solution Code: 
```cpp
#include <bits/stdc++.h> 

#define int long long 

using namespace std; 

const int inf = 1e18; 

int32_t main(){ 
	cin.tie(NULL)->sync_with_stdio(false); 
	int n; cin >> n; 
	vector <int> w(n + 2), l(n + 2); 
	for (int i = 1; i <= n; i++) cin >> w[i] >> l[i]; 
	vector <int> up(n + 2), down(n + 2), dpu(n + 2, inf), dpd(n + 2); dpu[0] = 0; 
	for (int i = 1; i <= n; i++) { 
		for (int j = i; j >= 1; j--) { 
			if (dpu[j - 1] <= l[i]) { 
				up[i] = max(up[i], j); 
				dpu[j] = min(dpu[j], dpu[j - 1] + w[i]); 
			} 
		} 
	} 
	dpd[0] = inf; 
	for (int i = n; i >= 1; i--) { 
		down[i] = down[i + 1];
		for (int j = n - i + 1; j >= 1; j--) { 
			if (dpd[j - 1] >= w[i]) { 
				down[i] = max(down[i], j);
				dpd[j] = max(dpd[j], min(l[i], dpd[j - 1] - w[i])); 
			} 
		} 
	} 
	int ans = 0; 
	for (int i = 1; i < n; i++) { 
		ans = max(ans, up[i] + down[i + 1]); 
	} 
	cout << ans << "\n"; 
	for (int i = 1; i < n; i++) { 
		if (up[i] + down[i + 1] == ans) cout << i << " "; 
	} 
}
```
## Total Time Complexity: $O(n^2)$

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢ comment ‡πÑ‡∏ß‡πâ‡πÉ‡∏ï‡πâ post ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üôá‚Äç‚ôÇÔ∏èüôá‚Äç‚ôÇÔ∏è
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEwMDQwNzU5Nl19
-->
